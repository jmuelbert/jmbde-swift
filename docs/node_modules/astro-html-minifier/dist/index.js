import { fileURLToPath } from "node:url";
import { defaultHTMLOptions, minifyHTML, } from "./html.js";
import { Logger } from "./logger.js";
import { mergeOptions } from "./utils.js";
const defaultOptions = {
    html: true,
};
// eslint-disable-next-line import/no-default-export
export default (opts = defaultOptions) => {
    const options = { ...defaultOptions, ...opts };
    const config = {
        html: mergeOptions(options.html, defaultHTMLOptions),
    };
    return {
        name: "astro-html-minifier",
        hooks: {
            "astro:build:done": async ({ dir }) => {
                const path = fileURLToPath(dir);
                if (config.html.enabled)
                    await minifyHTML(path, config.html.config);
                Logger.success("Minification finished\n");
            },
        },
    };
};
//# sourceMappingURL=index.js.map